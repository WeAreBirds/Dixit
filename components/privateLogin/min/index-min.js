"use strict";app.privateLoginView=kendo.observable({onShow:function(){app.storage.getItem("userInfo",function(e){if(e){var a=JSON.parse(e).userId,s=JSON.parse(e).userPassword;app.mobileApp.showLoading(),app.webservices.userValidationDate(a,s).done(function(e){if(200==e.ResultCode){if(e.ValidationDate){var a=e.ValidationDate.split(/\/|\s|:/),s=new Date(a[2],a[1],a[0],a[3],a[4],a[5]);s.setMonth(s.getMonth()-1);var o=new Date;s>o?(app.cache.setIsUserLogged(!0),app.mobileApp.navigate("components/privateSuccess/view.html")):(app.cache.setIsUserLogged(!1),app.storage.removeItem("userInfo",function(){app.webservices.init()}))}}else alert(app.translations.texts.error)}).always(function(){app.mobileApp.hideLoading()})}}),$("#mailDropDown label").click(function(){$("#mailDropDown label").removeClass("active"),$(this).addClass("active")})},onInit:function(){app.privateLoginView.set("translations",app.translations),$("#email").val(""),$("#email").on("input",function(e){var a=$("#email").val().slice(-1);if("@"==a){var s=$("#mailDropDown");s.css("display","block"),$("#mails").focus().click()}});var e=$("#createUserForm");e.on("submit",function(e){var a=$("#email").val();if(a=a.replace(/\s/g,""),a=a.toLowerCase(),e.preventDefault(),a||"@"==a.slice(-1)){$("#labelError").css("display","none"),$("#formInput").removeClass("error");var s=$("#mails").val();app.mobileApp.showLoading();var o=a+s;app.webservices.createUser(o).done(function(e){if(200==e.ResultCode&&e.UserId){var a={userId:e.UserId,userPassword:""};app.storage.setItem("userInfo",JSON.stringify(a)),app.mobileApp.navigate("components/privatePassword/view.html")}else alert(app.translations.texts.error)}).always(function(){app.mobileApp.hideLoading()})}else $("#labelError").css("display","block"),$("#formInput").addClass("error")})},dropDown:function e(){$("#mails").kendoDropDownList()}});