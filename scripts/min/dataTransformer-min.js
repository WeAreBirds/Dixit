app.dataTransformer={baseUrl:"https://dixit.bnpparibasfortis.be",relToAbs:function(e){if(/^(https?|file|ftps?|mailto|javascript|data:image\/[^;]{2,9};):/i.test(e))return e;if("//"==e.substring(0,2))return"https:"+e;if("/"==e.charAt(0))return this.baseUrl+e;if("./"==e.substring(0,2))e="."+e;else{if(/^\s*$/.test(e))return"";e="../"+e}e=this.baseUrl+"/"+e;for(var t=0;/\/\.\.\//.test(e=e.replace(/[^\/]+\/+\.\.\//g,"")););return e=e.replace(/\.$/,"").replace(/\/\./g,"").replace(/"/g,"%22").replace(/'/g,"%27").replace(/</g,"%3C").replace(/>/g,"%3E")},relativeUrlsToAbsolute:function(e){function t(e){var t=e.toLowerCase();if(u[e])return u[e];for(var a=e.toUpperCase(),r="",i=0;i<e.length;i++){var n=t.charAt(i);if(g[n])r+=g[n];else{var o=a.charAt(i),s=[n];s.push("&#0*"+n.charCodeAt(0)+l),s.push("&#x0*"+n.charCodeAt(0).toString(16)+l),n!=o&&(s.push("&#0*"+o.charCodeAt(0)+l),s.push("&#x0*"+o.charCodeAt(0).toString(16)+l)),s="(?:"+s.join("|")+")",r+=g[n]=s}}return u[e]=r}function a(e,t,a,r){return t+o.relToAbs(a)+r}function r(e,t,a,r){return a=a.replace(y,"/").replace(m,"."),t+o.relToAbs(a)+r}function i(t,r,i,n,o){"string"==typeof t&&(t=new RegExp(t,"gi")),r=s+r,i="string"==typeof i?i:"\\s*=\\s*",n="string"==typeof n?n:"",o="string"==typeof o?"?)("+o:")(";var l=new RegExp("("+r+i+'")([^"'+n+"]+"+o+")","gi"),u=new RegExp("("+r+i+"')([^'"+n+"]+"+o+")","gi"),g=new RegExp("("+r+i+")([^\"'][^\\s>"+n+"]*"+o+")","gi");e=e.replace(t,function(e){return e.replace(l,a).replace(u,a).replace(g,a)})}function n(t,a,i,n,o,l){"string"==typeof t&&(t=new RegExp(t,"gi")),a=s+a,n="string"==typeof n?n:"gi";var u=new RegExp("("+a+'\\s*=\\s*")([^"]*)',"gi"),g=new RegExp("("+a+"\\s*=\\s*')([^']+)","gi"),c=new RegExp("("+i+')([^"]+)(")',n),p=new RegExp("("+i+")([^']+)(')",n);if("string"==typeof o){l="string"==typeof l?l:"";var y=new RegExp("("+i+")([^\"'][^"+o+"]*"+(l?"?)("+l+")":")()"),n),m=function(e,t,a){return t+a.replace(c,r).replace(p,r).replace(y,r)}}else var m=function(e,t,a){return t+a.replace(c,r).replace(p,r)};e=e.replace(t,function(e){return e.replace(u,m).replace(g,m)})}var o=this,s="[^-a-z0-9:._]",l="(?:;|(?!\\d))",u={" ":"(?:\\s|&nbsp;?|&#0*32"+l+"|&#x0*20"+l+")","(":"(?:\\(|&#0*40"+l+"|&#x0*28"+l+")",")":"(?:\\)|&#0*41"+l+"|&#x0*29"+l+")",".":"(?:\\.|&#0*46"+l+"|&#x0*2e"+l+")"},g={},c=u[" "]+"*",p="(?:[^>\"']*(?:\"[^\"]*\"|'[^']*'))*?[^>]*",y=new RegExp(t("/"),"g"),m=new RegExp(t("."),"g");return n("<meta"+p+s+'http-equiv\\s*=\\s*(?:"'+t("refresh")+'"'+p+">|'"+t("refresh")+"'"+p+">|"+t("refresh")+"(?:"+t(" ")+p+">|>))","content",t("url")+c+t("=")+c,"i"),i("<"+p+s+"href\\s*="+p+">","href"),i("<"+p+s+"src\\s*="+p+">","src"),i("<object"+p+s+"data\\s*="+p+">","data"),i("<applet"+p+s+"codebase\\s*="+p+">","codebase"),i("<param"+p+s+'name\\s*=\\s*(?:"'+t("movie")+'"'+p+">|'"+t("movie")+"'"+p+">|"+t("movie")+"(?:"+t(" ")+p+">|>))","value"),i(/<style[^>]*>(?:[^"']*(?:"[^"]*"|'[^']*'))*?[^'"]*(?:<\/style|$)/gi,"url","\\s*\\(\\s*","","\\s*\\)"),n("<"+p+s+"style\\s*="+p+">","style",t("url")+c+t("(")+c,0,c+t(")"),t(")")),e},categories:function(e){return e.splice(app.webservices.newsPosition,0,{CssName:"",Id:null,Title:app.translations.texts.news,AnalyticTitle:window.texts.fr.news}),e},professionCategories:function(e){for(var t=0;t<e.length;t++)e[t].Index=t,e[t].CssName="","Functies"==e[t].Title?e[t].AnalyticTitle="Fonctions":e[t].AnalyticTitle=e[t].Title;return e},topArticles:function(e){for(var t=0;t<e.length;t++)e[t]={id:e[t].Id,categoryCssClass:e[t].MainCategory?e[t].MainCategory.CssName:"",categoryTitle:e[t].MainCategory?e[t].MainCategory.Title:"",image:e[t].TopImage?e[t].TopImage[0].ThumbnailUrl.AppImage:"",title:e[t].Title,header:e[t].Header,summary:e[t].Summary,date:"",vimeoVideoID:e[t].VimeoVideoID,youtubeVideoID:e[t].YoutubeVideoID,articleType:e[t].Type};return e},articles:function(e){for(var t=0;t<e.length;t++)e[t]={id:e[t].Id,categoryCssClass:e[t].MainCategory?e[t].MainCategory.CssName:"",categoryTitle:e[t].MainCategory?e[t].MainCategory.Title:"",image:e[t].TopImage?e[t].TopImage[0].ThumbnailUrl.AppImage:"",title:e[t].Title,header:e[t].Header,summary:e[t].Summary,date:e[t].PublicationDate,vimeoVideoID:e[t].VimeoVideoID,youtubeVideoID:e[t].YoutubeVideoID,articleType:e[t].Type};return e},article:function(e){var t=$.Deferred(),a=this;return app.storage.getItem("likes",function(r){r=null===r?[]:JSON.parse(r);var i=-1!==$.inArray(e.Id,r),n=[];if("undefined"!=typeof e.Gallery)for(var o=0;o<e.Gallery.length;o++)n.push(e.Gallery[o].ThumbnailUrl.AppImage);if(e={id:e.Id,categoryCssClass:e.MainCategory?e.MainCategory.CssName:"",categoryTitle:e.MainCategory?e.MainCategory.Title:"",image:e.TopImage?e.TopImage[0].ThumbnailUrl.AppImage:"",title:e.Title,analyticTitle:(e.MainCategory?e.MainCategory.AnalyticTitle+" : ":"")+e.AnalyticTitle,author:e.ArticleAuthor,date:e.PublicationDate,header:e.Header,quote:e.Quote,content:a.relativeUrlsToAbsolute(e.Content),tags:e.Tags,hasTags:e.Tags.length>0,showSurveyAnswers:!1,survey:e.Survey?e.Survey:null,showSurvey:!1,likes:e.Likes,url:e.Url,isLiked:i,gallery:n,hasGallery:n.length>0,isPrivate:e.Private,allowComments:e.AllowComments,externalContent:e.ExternalAdditionalContent,internalContent:e.InternalAdditionalContent,contactEmail:e.ContactEmail?"mailto:"+e.ContactEmail:"",vimeoVideoID:e.VimeoVideoID,youtubeVideoID:e.YoutubeVideoID,articleType:e.Type},e.survey)for(var o=1;5>=o;o++)"undefined"!=typeof e.survey["Answer"+o]&&(e.survey["FormattedCount"+o]=e.survey["CountAnswer"+o]+" ("+Math.round(e.survey["PercentageAnswer"+o])+"%)");null!==e.survey?app.storage.getItem("surveys",function(a){a=null===a?[]:JSON.parse(a),e.showSurveyAnswers=-1===$.inArray(e.survey.Id,a),e.showSurvey=!e.showSurveyAnswers,t.resolve(e)}):t.resolve(e)}),t},comments:function(e){for(var t=this,a=0;a<e.length;a++){var r=e[a].Replies;e[a]={id:e[a].Id,createdDate:t.parseJsonDate(e[a].CreatedDate),articleId:e[a].ArticleId,authorName:e[a].AuthorName,authorMail:e[a].AuthorMail,message:e[a].Message,validate:e[a].Validate,highlighted:e[a].Highlighted,replies:[]};for(var i=0;i<r.length;i++)e[a].replies[i]={id:r[i].Id,createdDate:t.parseJsonDate(r[i].CreatedDate),articleId:r[i].ArticleId,authorName:r[i].AuthorName,authorMail:r[i].AuthorMail,message:r[i].Message,validate:r[i].Validate,highlighted:r[i].Highlighted}}return e},parseJsonDate:function(e){var t=new Date(parseInt(e.replace("/Date(","")));return t.getDate()+"."+(t.getMonth()+1)+"."+t.getFullYear()},relatedArticles:function(e){for(var t=0;t<e.length;t++)e[t]={id:e[t].Id,categoryCssClass:e[t].MainCategory?e[t].MainCategory.CssName:"",categoryTitle:e[t].MainCategory?e[t].MainCategory.Title:"",image:e[t].TopImage?e[t].TopImage[0].ThumbnailUrl.AppImage:"",title:e[t].Title};return e},events:function(e){for(var t=0;t<e.length;t++)e[t]={id:e[t].Id,image:e[t].EventImageUrl?e[t].EventImageUrl.Url:"",title:e[t].Title,startDate:e[t].StartDate,startDay:e[t].StartDay,startDayMonth:e[t].StartDayMonth,startYear:e[t].StartYear,endDate:e[t].EndDate,endDay:e[t].EndDay,endDayMonth:e[t].EndDayMonth,endYear:e[t].EndYear,location:$.trim(e[t].Location.Street+" "+e[t].Location.City+" "+e[t].Location.State+" "+e[t].Location.Country),url:e[t].Url,title:e[t].Title,analyticTitle:e[t].StartYear+"/"+(moment(e[t].StartDate).month()+1)+" : "+e[t].AnalyticTitle,summary:e[t].Summary,content:e[t].Content};return e},event:function(e){var t=moment(e.startDate),a=moment(e.endDate);return t.hour()+t.minutes()==0?e.startTime=t.format("hh:mm"):e.startTime="",e.isSameDay=t.isSame(a,"day"),e}};